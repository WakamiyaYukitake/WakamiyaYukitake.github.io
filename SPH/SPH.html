<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>粒子法とSPH法</title>
    <link rel="stylesheet" href="../style.css">
    
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* 数式ブロックのマージン */
        .formula-block {
            margin: 24px 0;
            /* ▼ スマホ対応: 横スクロールを削除 ▼ */
        }
        
        /* MathJaxが生成する数式コンテナ */
        mjx-container[jax="SVG"][display="true"] {
            /* ▼ スマホ対応: 横スクロールを削除 ▼ */
        }

        /* ▼ スマホ対応: 画面幅が600px以下の場合 ▼ */
        @media (max-width: 600px) {
            .formula-block {
                /* ▼ 数式を70%に縮小してはみ出しを防止 ▼ */
                font-size: 60%;
            }
        }

        p {
            margin-bottom: 16px;
        }
        h3 {
            border-bottom: 2px solid var(--blue);
            padding-bottom: 8px;
            margin-top: 32px;
            margin-bottom: 16px;
        }
        code {
            background: rgba(255,255,255,0.05);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .highlight {
            color: var(--blue);
            font-weight: 600; 
        }

        /* 参考文献リンクのスタイル */
        #sph-method ul {
            list-style-type: disc;
            padding-left: 20px;
            margin-bottom: 16px;
        }
        #sph-method ul li a {
            color: var(--blue);
            text-decoration: none;
            transition: color 200ms;
        }
        #sph-method ul li a:hover {
            color: #fff;
            text-decoration: underline;
        }

        /* ▼ 図のスタイル ▼ */
        .illustration {
            max-width: 600px; /* 図の最大幅 */
            margin: 20px auto; /* 中央揃え */
            padding: 10px;
            background: rgba(255,255,255,0.02);
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.05);
            text-align: center;
        }
        .illustration p {
            font-style: italic;
            color: var(--muted);
            font-size: 14px;
            margin-bottom: 0;
        }
        .illustration svg {
            max-width: 100%;
        }
        
        /* ▼ 図1用スタイル ▼ */
        .comparison-box {
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            flex-wrap: wrap; /* スマホ用に折り返し */
        }
        .comparison-item {
            width: 45%;
            min-width: 150px; /* 最小幅 */
            text-align: center;
            margin-bottom: 15px;
        }
        .grid-container {
            display: grid;
            /* 8x8 グリッドに変更 */
            grid-template-columns: repeat(8, 1fr);
            border: 1px solid var(--muted);
            margin-top: 10px;
            width: 160px; /* 8x20px */
            height: 160px; /* 8x20px */
            margin-left: auto;
            margin-right: auto;
            background: #fff; /* 背景を白に */
        }
        .grid-cell {
            width: 100%;
            height: 100%;
            border: 1px solid rgba(0,0,0,0.1); /* グリッド線を薄い黒に */
            box-sizing: border-box; 
            background: transparent; /* デフォルトは透明 */
        }
        /* ▼ 図1 色定義 (画像1参考) ▼ */
        .grid-cell.water-deep { background: #0b5fff; }
        .grid-cell.water-mid { background: #5089ff; }
        .grid-cell.water-shallow { background: #a0c0ff; }
        .grid-cell.water-splash { background: #d0e0ff; }

        .particle-container {
            position: relative;
            width: 160px;
            height: 160px;
            border: 1px solid var(--muted);
            margin: 10px auto 0 auto;
        }
        .particle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--blue);
            border-radius: 50%;
        }

        /* SVG図用共通スタイル */
        .svg-text {
            font-size: 12px;
            fill: #fff;
        }
        .svg-text-muted {
            font-size: 12px;
            fill: var(--muted);
        }
        .particle-a { fill: var(--blue); stroke: #fff; stroke-width: 1px; }
        .particle-b { fill: rgba(255,255,255,0.4); }
        .kernel-radius { fill: none; stroke: var(--muted); stroke-dasharray: 4 2; }
        .arrow-green { stroke: var(--green); stroke-width: 1.5; marker-end: url(#arrowhead-green); }
        .arrow-purple { stroke: var(--purple); stroke-width: 2; marker-end: url(#arrowhead-purple); }
        .arrow-muted { stroke: var(--muted); stroke-width: 1.5; marker-end: url(#arrowhead-muted); }
        .arrow-muted-bi { stroke: var(--muted); stroke-width: 1.5; marker-end: url(#arrowhead-muted); marker-start: url(#arrowhead-muted-start); }
        .point-a { stroke: var(--blue); stroke-width: 3; }

    </style>
</head>
<body>

    <svg width="0" height="0" style="position:absolute; overflow:hidden;">
        <defs>
            <marker id="arrowhead-green" markerWidth="5" markerHeight="3.5" refX="5" refY="1.75" orient="auto"><polygon points="0 0, 5 1.75, 0 3.5" fill="var(--green)" /></marker>
            <marker id="arrowhead-purple" markerWidth="5" markerHeight="3.5" refX="5" refY="1.75" orient="auto"><polygon points="0 0, 5 1.75, 0 3.5" fill="var(--purple)" /></marker>
            <marker id="arrowhead-muted" markerWidth="5" markerHeight="3.5" refX="5" refY="1.75" orient="auto"><polygon points="0 0, 5 1.75, 0 3.5" fill="var(--muted)" /></marker>
            <marker id="arrowhead-muted-start" markerWidth="5" markerHeight="3.5" refX="0" refY="1.75" orient="auto"><polygon points="5 0, 0 1.75, 5 3.5" fill="var(--muted)" /></marker>
        </defs>
    </svg>

    <header class="site-header">
        <div class="container header-inner">
            <div class="logo">WY</div>
            <nav class="site-nav" id="site-nav">
                <a href="#particle-method">粒子法とは</a>
                <a href="#sph-method">SPH法</a>
            </nav>
            <button class="menu-btn" id="menu-btn" aria-label="Toggle navigation" aria-controls="site-nav" aria-expanded="false">☰</button>
        </div>
    </header>

    <section class="section--full hero-inner">
        <h1 class="hero-title">粒子法：SPH法</h1>
        <p class="hero-lead">
            粒子法の代表的な手法であるSPH法（Smoothed Particle Hydrodynamics）の基本原理について
        </p>
    </section>

    <div class="container">

        <section id="particle-method" class="section">
            <h2>粒子法とは</h2>
            <p>
                粒子法は、連続体の数値解析法の一つであり、解析対象である流体などを、任意の大きさを持つ<span class="highlight">粒子の集合体</span>として表現する手法である。
            </p>

            <h3>格子法との比較</h3>
            <p>
                従来広く用いられてきた格子法（有限体積法や有限要素法など）は、空間内に固定された格子点を計算点とする。 これは「オイラー的視点」に基づく。 対して、粒子法は空間内を<span class="highlight">移動する粒子そのもの</span>を計算点とする。 これは「ラグランジュ的視点」に基づいている。
            </p>
            
            <div class="illustration comparison-box">
                <div class="comparison-item">
                    <strong>格子法<br> (オイラー)</strong>
                    <div class="grid-container">
                        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell water-splash"></div>
                        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell water-deep"></div>
                        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell water-shallow"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-deep"></div>
                        <div class="grid-cell"></div><div class="grid-cell"></div><div class="grid-cell water-shallow"></div><div class="grid-cell water-shallow"></div><div class="grid-cell water-shallow"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-deep"></div>
                        <div class="grid-cell water-mid"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-mid"></div><div class="grid-cell water-deep"></div>
                        <div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div>
                        <div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div>
                        <div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div><div class="grid-cell water-deep"></div>
                    </div>
                </div>
                <div class="comparison-item">
                    <strong>粒子法<br> (ラグランジュ)</strong>
                    <div class="particle-container">
                        <span class="particle" style="top: 80%; left: 8%;"></span>
                        <span class="particle" style="top: 75%; left: 18%;"></span>
                        <span class="particle" style="top: 85%; left: 28%;"></span>
                        <span class="particle" style="top: 70%; left: 35%;"></span>
                        <span class="particle" style="top: 82%; left: 45%;"></span>
                        <span class="particle" style="top: 68%; left: 50%;"></span>
                        <span class="particle" style="top: 80%; left: 60%;"></span>
                        <span class="particle" style="top: 70%; left: 70%;"></span>
                        <span class="particle" style="top: 85%; left: 80%;"></span>
                        <span class="particle" style="top: 60%; left: 80%;"></span>
                        <span class="particle" style="top: 45%; left: 85%;"></span>
                        <span class="particle" style="top: 30%; left: 88%;"></span>
                        <span class="particle" style="top: 15%; left: 85%;"></span>
                        <span class="particle" style="top: 5%; left: 75%;"></span>
                        <span class="particle" style="top: 60%; left: 5%;"></span>
                        <span class="particle" style="top: 55%; left: 20%;"></span>
                        <span class="particle" style="top: 60%; left: 30%;"></span>
                        <span class="particle" style="top: 50%; left: 40%;"></span>
                        <span class="particle" style="top: 55%; left: 60%;"></span>
                        <span class="particle" style="top: 50%; left: 70%;"></span>
                        <span class="particle" style="top: 40%; left: 65%;"></span>
                    </div>
                </div>
            </div>
            <p style="text-align:center; margin-top: 5px; margin-bottom: 20px;" class="small-muted">図1: 格子法（オイラー的視点）と粒子法（ラグランジュ的視点）の比較</p>

            <ul>
                <li>
                    <span class="highlight">前処理（モデル生成）:</span> 3次元の複雑な地形を扱う場合、格子法では格子生成（メッシュ作成）に多くの時間が費やされる。 粒子法では粒子を配置する「粒子生成」のみであるため、格子生成より容易である。
                </li>
                <li>
                    <span class="highlight">移流項の扱い:</span> 格子法（オイラー的視点）では、支配方程式（ナビエ・ストークス方程式）の移流項を離散化する際に、数値拡散や数値振動といった問題が生じ、高精度な計算が困難になる場合がある。
                </li>
                <li>
                    <span class="highlight">粒子法の利点:</span> 粒子法（ラグランジュ的視点）では、粒子が移動することで流れを表現するため、移流項を解く必要がない。 これにより、移流項の離散化に伴う数値拡散や数値振動の問題が原理的に生じない。
                </li>
            </ul>

            <h3>粒子法の課題</h3>
            <p>
                一方で、粒子法は計算点が移動するため、圧力分布に非物理的な擾乱が生じやすいという課題がある。 この擾乱を減衰させるために、流体を「弱圧縮性」として扱うことが多いが、この手法は非物理的なエネルギーの減衰や体積の減少をもたらす可能性も指摘されている。
            </p>
        </section>

        <hr style="border-color: rgba(255,255,255,0.05); margin: 40px 0;">

        <section id="sph-method" class="section">
            <h2>SPH法</h2>
            <p>
                SPH法(Smoothed Particle Hydrodynamics)は粒子法の一つであり、各粒子が<span class="highlight">影響範囲</span>を持つと考える。 ある粒子の物理量は、その影響範囲内に存在する近傍の粒子から影響を受けて決定される。 この影響の度合いを定義するのが「カーネル関数」である。
            </p>

            <div class="illustration">
                <svg width="300" height="200" viewBox="0 0 300 200" xmlns="http://www.w3.org/2000/svg">
                    <path d="M 50 160 Q 150 20, 250 160" fill="rgba(106, 76, 255, 0.1)" stroke="var(--purple)" stroke-width="2" />
                    <ellipse cx="150" cy="160" rx="100" ry="20" fill="none" stroke="var(--purple)" stroke-dasharray="4 2" />

                    <line x1="150" y1="170" x2="150" y2="10" class="arrow-muted" />
                    <text x="155" y="20" class="svg-text">W (重み)</text>

                    <circle cx="150" cy="160" r="6" class="particle-a" />
                    <text x="135" y="185" class="svg-text">粒子 a</text>

                    <line x1="150" y1="160" x2="250" y2="160" class="arrow-muted-bi" />
                    <text x="195" y="155" class="svg-text" style="fill:var(--blue); font-weight: 600;">h (影響半径)</text>

                    <circle cx="100" cy="155" r="5" class="particle-b" />
                    <circle cx="180" cy="165" r="5" class="particle-b" />
                    <circle cx="220" cy="160" r="5" class="particle-b" />
                    <circle cx="130" cy="170" r="5" class="particle-b" />
                </svg>
                <p>図2: SPH法の基本概念。中心粒子aは影響半径h内の近傍粒子bから重みWを受けて相互作用する。</p>
            </div>

            <h3>カーネル関数による物理量の近似</h3>
            <p>
                ある位置ベクトル $r$ における物理量 $f(r)$ は、カーネル関数 $W$ を用いて、影響範囲内の積分として以下のように定義される。
            </p>
            <div class="formula-block">
                $$ f(r) = \int f(r') W(|r-r'|, h) dr' \tag{式1} $$
                
            </div>
            <p>
                また、式(1)は各粒子を表す添え字a,bを用いて、式(2)のように離散化できる。
            </p>
            <div class="formula-block">
                $$ f(r_{a})=\sum_{b}f(r_{b})W(|r_{a}-r_{b}|,h)\Delta V_{b} \tag{式2} $$
                
            </div>
            <p>
                ここで $h$ は粒子の影響範囲を定義する「平滑化長さ」である。
                粒子 $b$ の体積を $\Delta V_b$、質量を $m_b$、密度を $\rho_b$ とすると、 $\Delta V_b = m_b / \rho_b$ の関係から、粒子 $a$ の物理量 $f(r_a)$ は以下の和として近似できる。
            </p>
            <div class="formula-block">
                $$ f(r_a) = \sum_b f(r_b) \frac{m_b}{\rho_b} W(|r_a - r_b|, h) \tag{式3} $$
                
            </div>

            <div class="illustration">
                <svg width="300" height="150" viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="150" cy="75" r="6" class="particle-a" />
                    <text x="135" y="100" class="svg-text">f(ra) を計算</text>
                    
                    <circle cx="100" cy="50" r="5" class="particle-b" />
                    <line x1="104" y1="53" x2="145" y2="72" class="arrow-green" />
                    <text x="45" y="45" class="svg-text" style="fill: var(--green);">f(rb) * W</text>
                    
                    <circle cx="180" cy="40" r="5" class="particle-b" />
                    <line x1="177" y1="43" x2="154" y2="71" class="arrow-green" />
                    
                    <circle cx="110" cy="110" r="5" class="particle-b" />
                    <line x1="113" y1="107" x2="146" y2="80" class="arrow-green" />

                    <circle cx="200" cy="95" r="5" class="particle-b" />
                    <line x1="197" y1="93" x2="155" y2="78" class="arrow-green" />
                    <text x="205" y="105" class="svg-text" style="fill: var(--green);">f(rb) * W</text>
                </svg>
                <p>図3: 粒子aの物理量（式3）は、近傍の粒子bが持つ物理量 $f(rb)$ の重み付け和で計算される。</p>
            </div>

            <p>
                カーネル関数 $W$ にはいくつかの種類があるが、ここでは Wendland kernel を用いる。 $q$ は粒子間の無次元距離 ($q=r/h$) である。
            </p>
            <div class="formula-block">
                $$ W(r,h)=\alpha_{D} \begin{cases} (1-\frac{q}{2})^{4}(2q+1) & 0 \le q \le 2 \\ 0 & q > 2 \end{cases} \tag{式4} $$
                
            </div>

            <h3>支配方程式の離散化</h3>
            <p>
                SPH法では、流体の運動を記述する「ナビエ・ストークス方程式」と「連続式」を、前述の<span class="highlight">カーネル関数</span>を用いて離散化する。
                流体は弱圧縮性流体とする。 
            </p>
            <h4>ナビエ・ストークス方程式</h4>
            <p>
                粒子の体積を $\Delta V[m^{3}]$ とすると、粒子にかかる圧力が $-V \nabla p$ ,粘性力が $\mu\nabla^{2}u$ であることから、式(5)が求められる。
            </p>
            <div class="formula-block">
                $$ m\frac{du}{dt}=-V\nabla p+V\mu\nabla^{2}u+mg \tag{式5} $$
                
            </div>

            <div class="illustration">
                <svg width="250" height="150" viewBox="0 0 250 150" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="125" cy="75" r="10" class="particle-a" />
                    
                    <line x1="125" y1="65" x2="125" y2="35" class="arrow-green" />
                    <text x="130" y="45" class="svg-text" style="fill: var(--green);">-V∇p (圧力)</text>
                    
                    <line x1="85" y1="75" x2="115" y2="75" class="arrow-purple" />
                    <text x="10" y="79" class="svg-text" style="fill: var(--purple);">Vμ∇²u (粘性)</text>

                    <line x1="125" y1="85" x2="125" y2="115" class="arrow-muted" />
                    <text x="130" y="110" class="svg-text-muted">mg (重力)</text>
                </svg>
                <p>図4: 一つの流体粒子にかかる力（圧力による力、粘性力、重力）の概念図。</p>
            </div>

            <p>
                ここで、uは粒子の速度[m/s], pは圧力[Pa], $\mu$は粘性係数[Pas], gは重力加速度[m/s²]である。 また、粒子の密度を $\rho[kg/m^{3}]$ とすると、 $m=\rho V$ であることから、式(6)が得られる。
            </p>
            <div class="formula-block">
                $$ \rho\frac{du}{dt}=-\nabla p+\mu\nabla^{2}u+\rho g \tag{式6} $$
                
            </div>
            <p>
                vを動粘性係数[$m^{2}/s$]とすると粘性項の係数は $\mu/\rho = v$ から、式(7)が得られる。
            </p>
            <div class="formula-block">
                $$ \frac{du}{dt} = - \frac{1}{\rho} \nabla p + \nu \nabla^2 u + g \tag{式7} $$
                
            </div>
            <p>
                この式(7)をSPH法に基づき離散化すると、粒子 $a$ の速度変化（加速度） $\frac{du_a}{dt}$ は、近傍の粒子 $b$ との相互作用として以下の（式8）で表される。
            </p>
            <div class="formula-block">
                $$ \frac{du_a}{dt} = - \sum_b m_a \left( \frac{p_b}{\rho_b^2} + \frac{p_a}{\rho_a^2} + \Pi_{ab} \right) \nabla W(|r_a - r_b|, h) + g \tag{式8} $$
                
            </div>
            <p>
                ここで、$\Pi_{ab}$ は数値的な安定性を確保するために導入される「人工粘性項」であり、粒子同士が近づきすぎた場合に反発力として機能する。
            </p>
            <div class="formula-block">
                $$ \Pi_{ab} = \begin{cases} \frac{-\alpha \bar{c}_{ab} \mu_{ab}}{\bar{\rho}_{ab}} & v_{ab} \cdot r_{ab} < 0 \\ 0 & v_{ab} \cdot r_{ab} > 0 \end{cases} \tag{式9} $$
                
            </div>

            <h4>連続式（質量保存則）</h4>
            <p>
                流体の密度 $\rho$ の時間変化は、連続式によって記述される。 粒子 $a$ の密度変化 $\frac{d\rho_a}{dt}$ は、近傍粒子 $b$ との速度差 $u_a - u_b$ を用いて、以下の（式10）で表される。
            </p>
            <div class="formula-block">
                $$ \frac{d\rho_a}{dt} = - \rho_a \sum_b \frac{m_b}{\rho_b} (u_a - u_b) \cdot \nabla W(|r_a - r_b|, h) \tag{式10} $$
                
            </div>
            
            <h4>状態方程式</h4>
            <p>
                SPH法では流体を「弱圧縮性」として扱うため、密度 $\rho$ と圧力 $p$ を関係づける「状態方程式」が必要となる。 以下の（式11）が用いられる。
            </p>
            <div class="formula-block">
                $$ p = \frac{c_0^2 \rho_0}{\gamma} \left( \left( \frac{\rho}{\rho_0} \right)^\gamma - 1 \right) \quad (\gamma = 7) \tag{式11} $$
                
            </div>
            
            <p>
                ここで $c_0$ は基準となる音速、 $\rho_0$ は基準密度である。 圧力 $p$ は密度の変化（圧縮）によって生じる力として計算される。
            </p>
            
            <h3>数値計算</h3>
            <p>
                シミュレーションの結果として、特定の点における流速 $v_a$ や圧力 $p_a$ は、その点に隣接する流体粒子 $b$ の速度 $v_b$ や圧力 $p_b$ をカーネル関数で重み付け平均することで求められる。
            </p>
            <div class="formula-block">
                $$ v_a = \frac{\sum_b v_b W(|r_a - r_b|, h)}{\sum_b W(|r_a - r_b|, h)} \tag{式12} $$
                
            </div>
            <div class="formula-block">
                $$ p_a = \frac{\sum_b p_b W(|r_a - r_b|, h)}{\sum_b W(|r_a - r_b|, h)} \tag{式13} $$
                
            </div>

            <div class="illustration">
                <svg width="250" height="150" viewBox="0 0 250 150" xmlns="http://www.w3.org/2000/svg">
                    <line x1="120" y1="70" x2="130" y2="80" class="point-a" />
                    <line x1="120" y1="80" x2="130" y2="70" class="point-a" />
                    <text x="110" y="100" class="svg-text">点 a (Va, Pa)</text>

                    <circle cx="125" cy="75" r="50" class="kernel-radius" />
                    
                    <circle cx="95" cy="60" r="5" class="particle-b" />
                    <text x="85" y="50" class="svg-text-muted">Vb, Pb</text>
                    <circle cx="145" cy="50" r="5" class="particle-b" />
                    <text x="135" y="40" class="svg-text-muted">Vb, Pb</text>
                    <circle cx="125" cy="110" r="5" class="particle-b" />
                    <circle cx="155" cy="90" r="5" class="particle-b" />
                </svg>
                <p>図5: 物理量の計算（式12, 13）。任意の点aの物理量は、近傍の粒子bが持つ物理量を重み付け平均して算出される。</p>
            </div>

            <h3 style="margin-top: 40px;">参考文献</h3>
            <p>
                その他、DualSPHysicsにおける計算式は以下ページを参考。
            </p>
            <ul>
                <li><a href="https://github.com/DualSPHysics/DualSPHysics/wiki/3.-SPH-formulation" target="_blank" rel="noopener noreferrer">DualSPHysics Wiki - 3. SPH formulation</a></li>
            </ul>

        </section>

    </div><footer class="site-footer">
        <p class="small-muted">© 2025 Wakamiya Yukitake.</p>
    </footer>

    <script>
        // Mobile menu toggle
        const menuBtn = document.getElementById('menu-btn');
        const siteNav = document.getElementById('site-nav');
        if (menuBtn && siteNav) {
            menuBtn.addEventListener('click', () => {
                const isOpen = siteNav.classList.toggle('open');
                menuBtn.setAttribute('aria-expanded', isOpen);
            });
        }

        // Scroll-in-view animation
        const sections = document.querySelectorAll('.section');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('in-view');
                }
            });
        }, {
            threshold: 0.1
        });

        sections.forEach(section => {
            observer.observe(section);
        });
    </script>
</body>
</html>